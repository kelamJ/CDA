-- 9.
SELECT MAX(OrderDate) FROM `orders`
JOIN customers on customers.CustomerID = orders.CustomerID
WHERE CompanyName = "Du monde entier";
DELIMITER |

CREATE PROCEDURE SansCommande(
    In numfou varchar (25),
    In annee date(10)
)

BEGIN
    SELECT fournis.numfou, fournis.nomfou, SUM(ligcom.qtecde * ligcom.priuni * 1.2)
    FROM fournis
    JOIN entcom ON entcom.numfou = fournis.numfou
    JOIN ligcom ON ligcom.numcom = entcom.numcom
    WHERE YEAR (datcom) = annee AND fournis.numfou = numfou
    GROUP BY fournis.numfou, nomfou;
END |

DELIMITER ;



-- 10.
SELECT round(avg(datediff(ShippedDate, OrderDate))) as "DÃ©lai moyen de livraison en jours"
FROM `orders`;